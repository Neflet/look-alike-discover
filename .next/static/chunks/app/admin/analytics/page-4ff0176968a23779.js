(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[668],{1880:function(e,s,t){Promise.resolve().then(t.bind(t,8822))},8822:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return h}});var n=t(7437),i=t(2265),r=t(9026),a=t(781),l=t(2595),c=t(2660),d=t(7168),o=t(7648),u=t(9376);let m=["ohiomokhaimusa@gmail.com"];function h(){var e;let{user:s,loading:t}=(0,r.a)(),h=(0,u.useRouter)(),[x,p]=(0,i.useState)([]),[v,f]=(0,i.useState)(null),[b,y]=(0,i.useState)(!0),[g,j]=(0,i.useState)(null);(0,i.useEffect)(()=>{if(!t&&s){var e;let t=null===(e=s.email)||void 0===e?void 0:e.toLowerCase();if(!t||!m.includes(t)){h.push("/");return}}else if(!t&&!s){h.push("/");return}},[s,t,h]);let N=async()=>{y(!0),j(null);try{let{data:e,error:s}=await a.O.rpc("get_analytics_events",{p_limit:100});if(s)throw s;p(e||[]);let t={},n=new Set,i=new Set;(e||[]).forEach(e=>{t[e.event_type]=(t[e.event_type]||0)+1,e.user_id&&n.add(e.user_id),e.session_id&&i.add(e.session_id)}),f({events_by_type:Object.entries(t).map(e=>{let[s,t]=e;return{event_type:s,count:t}}),unique_users:n.size,unique_sessions:i.size,total_events:(null==e?void 0:e.length)||0})}catch(e){j(e.message||"Failed to load analytics")}finally{y(!1)}};return((0,i.useEffect)(()=>{var e;s&&m.includes((null===(e=s.email)||void 0===e?void 0:e.toLowerCase())||"")&&N()},[s]),t)?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsx)("div",{children:"Loading..."})}):s&&m.includes((null===(e=s.email)||void 0===e?void 0:e.toLowerCase())||"")?(0,n.jsx)("div",{className:"min-h-screen bg-background p-6",children:(0,n.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)(o.default,{href:"/",children:(0,n.jsxs)(l.z,{variant:"ghost",size:"sm",children:[(0,n.jsx)(c.Z,{className:"w-4 h-4 mr-2"}),"Back to Search"]})}),(0,n.jsx)("h1",{className:"text-3xl font-bold",children:"Analytics Dashboard"})]}),(0,n.jsxs)(l.z,{onClick:N,disabled:b,size:"sm",children:[(0,n.jsx)(d.Z,{className:"w-4 h-4 mr-2 ".concat(b?"animate-spin":"")}),"Refresh"]})]}),g&&(0,n.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:g}),v&&(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,n.jsxs)("div",{className:"bg-muted/50 border rounded-lg p-4",children:[(0,n.jsx)("div",{className:"text-sm opacity-60 mb-1",children:"Total Events"}),(0,n.jsx)("div",{className:"text-2xl font-bold",children:v.total_events})]}),(0,n.jsxs)("div",{className:"bg-muted/50 border rounded-lg p-4",children:[(0,n.jsx)("div",{className:"text-sm opacity-60 mb-1",children:"Unique Users"}),(0,n.jsx)("div",{className:"text-2xl font-bold",children:v.unique_users})]}),(0,n.jsxs)("div",{className:"bg-muted/50 border rounded-lg p-4",children:[(0,n.jsx)("div",{className:"text-sm opacity-60 mb-1",children:"Unique Sessions"}),(0,n.jsx)("div",{className:"text-2xl font-bold",children:v.unique_sessions})]}),(0,n.jsxs)("div",{className:"bg-muted/50 border rounded-lg p-4",children:[(0,n.jsx)("div",{className:"text-sm opacity-60 mb-1",children:"Event Types"}),(0,n.jsx)("div",{className:"text-2xl font-bold",children:v.events_by_type.length})]})]}),v&&v.events_by_type.length>0&&(0,n.jsxs)("div",{className:"bg-background border rounded-lg p-6 mb-6",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Events by Type"}),(0,n.jsx)("div",{className:"space-y-2",children:v.events_by_type.map(e=>(0,n.jsxs)("div",{className:"flex items-center justify-between py-2 border-b",children:[(0,n.jsx)("span",{className:"font-medium",children:e.event_type}),(0,n.jsxs)("span",{className:"text-sm opacity-60",children:[e.count," events"]})]},e.event_type))})]}),(0,n.jsxs)("div",{className:"bg-background border rounded-lg p-6",children:[(0,n.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["Recent Events (",x.length,")"]}),b?(0,n.jsx)("div",{className:"text-center py-8",children:"Loading..."}):0===x.length?(0,n.jsx)("div",{className:"text-center py-8 text-sm opacity-60",children:"No events found"}):(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"w-full text-sm",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{className:"border-b",children:[(0,n.jsx)("th",{className:"text-left py-2 px-2",children:"Time"}),(0,n.jsx)("th",{className:"text-left py-2 px-2",children:"Event Type"}),(0,n.jsx)("th",{className:"text-left py-2 px-2",children:"User"}),(0,n.jsx)("th",{className:"text-left py-2 px-2",children:"Details"})]})}),(0,n.jsx)("tbody",{children:x.map(e=>(0,n.jsxs)("tr",{className:"border-b",children:[(0,n.jsx)("td",{className:"py-2 px-2 text-xs opacity-60",children:new Date(e.created_at).toLocaleString()}),(0,n.jsx)("td",{className:"py-2 px-2",children:(0,n.jsx)("span",{className:"font-medium",children:e.event_type})}),(0,n.jsx)("td",{className:"py-2 px-2 text-xs opacity-60",children:e.user_id?e.user_id.substring(0,8)+"...":"Anonymous"}),(0,n.jsx)("td",{className:"py-2 px-2 text-xs opacity-60 max-w-xs truncate",children:JSON.stringify(e.event_data)})]},e.id))})]})})]})]})}):(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center p-6",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Access Denied"}),(0,n.jsx)("p",{className:"text-sm opacity-60 mb-4",children:"You don't have permission to view analytics."}),(0,n.jsx)(o.default,{href:"/",children:(0,n.jsx)(l.z,{children:"Go Home"})})]})})}},2595:function(e,s,t){"use strict";t.d(s,{z:function(){return d}});var n=t(7437),i=t(2265),r=t(7053),a=t(535),l=t(2835);let c=(0,a.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/80 transition-colors",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-primary bg-background hover:bg-primary hover:text-primary-foreground transition-colors",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 px-3",lg:"h-11 px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=i.forwardRef((e,s)=>{let{className:t,variant:i,size:a,asChild:d=!1,...o}=e,u=d?r.g7:"button";return(0,n.jsx)(u,{className:(0,l.cn)(c({variant:i,size:a,className:t})),ref:s,...o})});d.displayName="Button"},9026:function(e,s,t){"use strict";t.d(s,{AuthProvider:function(){return l},a:function(){return c}});var n=t(7437),i=t(2265),r=t(781);let a=(0,i.createContext)({user:null,session:null,loading:!0,signIn:async()=>({error:null}),signUp:async()=>({error:null}),signOut:async()=>{}});function l(e){let{children:s}=e,[t,l]=(0,i.useState)(null),[c,d]=(0,i.useState)(null),[o,u]=(0,i.useState)(!0);(0,i.useEffect)(()=>{let{data:{subscription:e}}=r.O.auth.onAuthStateChange((e,s)=>{var t;d(s),l(null!==(t=null==s?void 0:s.user)&&void 0!==t?t:null),u(!1)});return r.O.auth.getSession().then(e=>{var s;let{data:{session:t}}=e;d(t),l(null!==(s=null==t?void 0:t.user)&&void 0!==s?s:null),u(!1)}),()=>e.unsubscribe()},[]);let m=async(e,s)=>{let{error:t}=await r.O.auth.signInWithPassword({email:e,password:s});return t||(window.location.href="/"),{error:t}},h=async(e,s,t)=>{let n="".concat(window.location.origin,"/"),{error:i}=await r.O.auth.signUp({email:e,password:s,options:{emailRedirectTo:n,data:{display_name:t}}});return{error:i}},x=async()=>{await r.O.auth.signOut()};return(0,n.jsx)(a.Provider,{value:{user:t,session:c,loading:o,signIn:m,signUp:h,signOut:x},children:s})}let c=()=>{let e=(0,i.useContext)(a);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},781:function(e,s,t){"use strict";t.d(s,{O:function(){return n}});let n=(0,t(1545).eI)("https://veikyjfcycgpkpwdbksa.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZlaWt5amZjeWNncGtwd2Ria3NhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQwMjA0OTAsImV4cCI6MjA2OTU5NjQ5MH0.xPFTAJVSpVS4hcbnzmILDItpSphcP2aKTPSFo1VbB2s",{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0}})},2835:function(e,s,t){"use strict";t.d(s,{cn:function(){return r}});var n=t(1994),i=t(3335);function r(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,i.m6)((0,n.W)(s))}}},function(e){e.O(0,[545,80,978,971,117,744],function(){return e(e.s=1880)}),_N_E=e.O()}]);